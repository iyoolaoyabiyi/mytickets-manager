## Models (client + mock API)

```ts
type User = {
  id: number
  name: string
  email: string
  // password exists only in mock db.json for demo
  created_at: string // ISO
  updated_at: string // ISO
}

type TicketStatus = "open" | "in_progress" | "closed"
type TicketPriority = "high" | "medium" | "low"

type Ticket = {
  id: number
  title: string
  description?: string
  status: TicketStatus
  priority?: TicketPriority
  created_at: string // ISO
  updated_at: string // ISO
}

type Session = {
  user: { id: number; name: string; email: string }
  token: string
  expiresAt: number
}

```

### Endpoints (mock)

- `POST /auth/login` -> `{ user, token, expiresAt }` (24h), **to populate** `ticketapp_session`.
- `POST /auth/signup` -> `{ id, name, email }`
- `GET /tickets?status=open&_sort=updated_at&_order=desc` (json-server query works out of the box)
- `POST /tickets` (server sets timestamps)
- `PUT/PATCH /tickets/:id` (server updates `updated_at`)
- `DELETE /tickets/:id`

## States

## Auth slice

```ts
AuthState = {
  user: null | { id, name, email },
  token: null | string,
  expiresAt: null | number,
  status: "idle" | "authenticating" | "authenticated" | "error",
  error?: string
}
```

**Actions**

- `auth/login(email, password)` -> POST `/auth/login` -> on success:
    - `localStorage.setItem('ticketapp_session', JSON.stringify(session))`
    - toast `toast.auth.success`, route `/dashboard`
- `auth/signup(data)` -> POST `/auth/signup` -> toast `toast.postsignup`, route `/auth/login`
- `auth/logout()` -> clear `ticketapp_session` -> toast `toast.auth.end`, route `/auth/login`
- `auth/restore()` (on app start) -> read/validate `ticketapp_session`; if **missing/expired**: clear and toast `toast.session.expired` when redirecting to a protected route.

## Tickets slice

```ts
TicketsState = {
  items: [] as Ticket[],
  filters: { 
	  q: "", 
	  status: "all" as "all"|TicketStatus, 
	  priority: "all" as "all"|TicketPriority 
	},
  status: "idle" | "loading" | "ready" | "error",
  modal: { 
	  type: "closed" | "create" | "edit", 
	  draft: null as null | Partial<Ticket> 
	},
  deletingId: null as null | number,
  error?: string
}
```

**Actions**

- `tickets/load()` -> GET `/tickets` (+ query by filters) -> on error toast `toast.load.error`.
- `tickets/create(draft)` -> POST `/tickets`
    - success: close modal, toast `toast.create.success`, refresh list    
    - validation error: inline + toast `toast.validation`     
    - network: toast `toast.network.error` 
- `tickets/update(id, draft)` -> PUT `/tickets/:id` -> toast `toast.update.success` or appropriate error toast 
- `tickets/delete(id)` -> DELETE -> toast `toast.delete.success` or `toast.load.error` on 404
- `tickets/applyFilters(...)` -> updates `filters`, triggers `load()` 

## UI slice

```ts
UIState = {
  toasts: [] as { id, type: "success"|"error"|"info", messageKey: string, params?: any }[],
  theme: "light" | "dark"
}
```

- Use `c-toast` with proper ARIA: success/info = `role="status"`, error = `role="alert"`.

---

## Guard helpers (client)

```ts
export function requireAuth(): boolean {
  const raw = localStorage.getItem("ticketapp_session");
  if (!raw) return false;
  try {
    const s: Session = JSON.parse(raw);
    if (!s.token || !s.user) return false;
    if (s.expiresAt && Date.now() > s.expiresAt) return false;
    return true;
  } catch { return false; }
}
```

- On protected routes, if `requireAuth()` is false -> redirect `/auth/login` and show `toast.session.expired`/`toast.session.invalid` from your copy.