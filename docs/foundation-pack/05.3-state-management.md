## Validation & error scenarios (what triggers toasts vs. inline)

**Forms (inline under fields):**
- Login/Signup: required, email format, password length, confirm mismatch.
- Ticket Create/Edit: title required, status required, optional description length.

**Toasts (global):**
- Auth success/error; session expired/invalid; network/load errors; ticket created/updated/deleted.
- Login invalid credentials: show error toast “Invalid email or password.” + inline as needed.

Mapping used by the helpers:
- Inline: `validation.*` keys from `validation.ts` (e.g., `validation.email`) resolve to your deck lines above.
- Toasts: `ToastKeys` -> `toast.*` keys in your deck.

---

## State to components map

**Global**
- **`c-toast`**: renders queue from `ui.toasts`, roles vary by type (status/alert). Actions: `UI/TOAST_DISMISS`.
- **`c-modal`**: driven by `tickets.modal` (closed/create/edit) and `tickets.deleting` (confirm). `role="dialog" aria-modal="true"`.

**Auth**
- **`c-auth-form --login` / `--signup`**: binds to local form state; dispatch auth actions; show inline errors via `aria-describedby`.
    - Submit -> `AUTH/LOGIN_REQUEST|SIGNUP_REQUEST` -> API -> success toast + redirect, or error toast + inline.

**Tickets (List & Form-in-Modal)**
- **`c-filters`**: reads/writes `tickets.filters` (`q`, `status`, `priority`). `onChange` -> `TICKETS/FILTERS_SET` -> reload. Proper labels on controls.
- **`c-ticket-card`**: reads a ticket from normalized cache; actions: **Edit** -> `TICKETS/EDIT_OPEN(id)`, **Delete** -> `TICKETS/DELETE_CONFIRM(id)`.
- **`c-ticket-form --create|--update`** (in modal): binds to `tickets.modal.draft`, disables submit while saving; inline field errors; Save -> `TICKETS/CREATE_REQUEST|UPDATE_REQUEST`.
- **`c-empty --primary|--filtered`**: conditional rendering from derived selectors (no tickets vs. no matches).
- **Delete confirmation (`c-modal`)**: uses `tickets.deleting.status`. Confirm -> `TICKETS/DELETE_REQUEST`.

**Dashboard**
- **`c-stat-card`**: reads derived counts from tickets; shows values/labels.

---

## State flows 

**(A) Auth: Login**

1. User submits `c-auth-form --login` -> `AUTH/LOGIN_REQUEST` (disable button: `is-loading`).
2. API `/auth/login` -> on success: save `ticketapp_session`, dispatch `AUTH/LOGIN_SUCCESS` + toast “Welcome back {name}” + redirect to `/dashboard`. On failure: `AUTH/LOGIN_FAILURE` + toast “Invalid email or password.” and inline field errors.

**(B) Route guard**
- Visiting `/dashboard` or `/tickets` checks session. If missing/expired: redirect to `/auth/login` and toast “Session expired”. Use `ensureAuthed()` for this.

**(C) Tickets: load & filter**
1. Enter `/tickets` -> `TICKETS/LOAD_REQUEST` -> API `GET /tickets?…` built from `filters.ts` -> `TICKETS/LOAD_SUCCESS`.
2. Change Search/Status/Priority in `c-filters` -> `TICKETS/FILTERS_SET` -> reload. If network failure: toast `toast.load.error`.

**(D) Create ticket (modal)**
1. Click **New Ticket** -> `TICKETS/CREATE_OPEN` -> show `c-ticket-form --create`.
2. Validate with `TicketCreateSchema`. If invalid: inline messages + optional toast `toast.validation`.
3. `TICKETS/CREATE_REQUEST` -> API `POST /tickets` -> success: `TICKETS/CREATE_SUCCESS` + toast “Ticket created successfully.”; close modal; list updates. Failure: `TICKETS/CREATE_FAILURE` + toast `toast.network.error`.

**(E) Edit ticket (inline modal on /tickets)**
1. **Edit** on a card -> `TICKETS/EDIT_OPEN(id)`; form prefilled from cache.
2. Submit -> Zod validate -> `TICKETS/UPDATE_REQUEST` -> API `PATCH /tickets/:id` -> `TICKETS/UPDATE_SUCCESS` + toast “Ticket updated successfully.”; close. On failure: `TICKETS/UPDATE_FAILURE` + toast `toast.network.error`.

**(F) Delete ticket**
1. **Delete** on a card -> `TICKETS/DELETE_CONFIRM(id)` -> confirm modal.
2. Confirm -> `TICKETS/DELETE_REQUEST` -> API `DELETE /tickets/:id` -> `TICKETS/DELETE_SUCCESS` + toast “Ticket deleted.”; or `TICKETS/DELETE_FAILURE` + error toast.